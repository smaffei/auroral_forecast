
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>API references &#8212; ChaosMagPy 0.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ChaosMagPy 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="api-references">
<h1>API references<a class="headerlink" href="#api-references" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-chaos">
<span id="core-functionality-chaos"></span><h2>Core functionality (<cite>CHAOS</cite>)<a class="headerlink" href="#module-chaos" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chaos.BaseModel">
<em class="property">class </em><code class="descclassname">chaos.</code><code class="descname">BaseModel</code><span class="sig-paren">(</span><em>breaks=None</em>, <em>order=None</em>, <em>coeffs=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for time-dependent (piecewise polynomial) model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">Break points for piecewise-polynomial representation of the
time-dependent internal field in modified Julian date format.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of polynomial pieces (e.g. 4 = cubic) of the time-dependent
field.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of the time-dependent field.</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<cite>k</cite>, <cite>m</cite>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent field.</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}</span></dt>
<dd><p class="first last">Internal or external source (defaults to <code class="docutils literal notranslate"><span class="pre">'internal'</span></code>)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">Break points for piecewise-polynomial representation of the
magnetic field in modified Julian date format.</p>
</dd>
<dt><strong>pieces</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Number <cite>m</cite> of intervals given by break points in <code class="docutils literal notranslate"><span class="pre">breaks</span></code>.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of polynomial pieces (e.g. 4 = cubic) of the time-dependent
field.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of the time-dependent field.</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<cite>k</cite>, <cite>m</cite>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent field.</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}</span></dt>
<dd><p class="first last">Internal or external source (defaults to <code class="docutils literal notranslate"><span class="pre">'internal'</span></code>)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chaos.BaseModel.plot_maps">
<code class="descname">plot_maps</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.plot_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.plot_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global maps of the field components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options are passed to <a class="reference internal" href="#plot_utils.plot_maps" title="plot_utils.plot_maps"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_utils.plot_maps()</span></code></a>
function.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#plot_utils.plot_maps" title="plot_utils.plot_maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_utils.plot_maps</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="chaos.BaseModel.plot_power_spectrum">
<code class="descname">plot_power_spectrum</code><span class="sig-paren">(</span><em>time</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.plot_power_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.plot_power_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot power spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time in modified Julian date.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.BaseModel.power_spectrum" title="chaos.BaseModel.power_spectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseModel.power_spectrum</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="chaos.BaseModel.plot_timeseries">
<code class="descname">plot_timeseries</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.plot_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.plot_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time series of the time-dependent field components at a
specific location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Time series plot of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘linear’, ‘spline’, ‘constant’, ‘off’}, optional</span></dt>
<dd><p class="first last">Extrapolate to times outside of the model bounds. Defaults to
<code class="docutils literal notranslate"><span class="pre">'linear'</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to <a class="reference internal" href="#plot_utils.plot_timeseries" title="plot_utils.plot_timeseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_utils.plot_timeseries()</span></code></a>
function.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#plot_utils.plot_timeseries" title="plot_utils.plot_timeseries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_utils.plot_timeseries</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="chaos.BaseModel.power_spectrum">
<code class="descname">power_spectrum</code><span class="sig-paren">(</span><em>time</em>, <em>radius=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.power_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.power_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the powerspectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Time in modified Julian date.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radius in kilometers (defaults to mean Earth’s surface defined in
<code class="docutils literal notranslate"><span class="pre">basicConfig['r_surf']</span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>R_n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>)</span></dt>
<dd><p class="first last">Power spectrum of spherical harmonics up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to <a class="reference internal" href="#chaos.BaseModel.synth_coeffs" title="chaos.BaseModel.synth_coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.synth_coeffs()</span></code></a> method.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.power_spectrum" title="model_utils.power_spectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model_utils.power_spectrum</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="chaos.BaseModel.synth_coeffs">
<code class="descname">synth_coeffs</code><span class="sig-paren">(</span><em>time</em>, <em>*</em>, <em>nmax=None</em>, <em>deriv=None</em>, <em>extrapolate=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.synth_coeffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.synth_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the field coefficients at points in time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (None defaults to 0). For secular variation,
choose <code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘linear’, ‘quadratic’, ‘cubic’, ‘spline’, ‘constant’, ‘off’} or int, optional</span></dt>
<dd><p class="first">Extrapolate to times outside of the model bounds. Specify
polynomial degree as string or any order as integer. Defaults to
<code class="docutils literal notranslate"><span class="pre">'linear'</span></code> (equiv. to order 2 polynomials).</p>
<blockquote class="last">
<div><table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>‘constant’</td>
<td>Use degree zero polynomial only (extrapolate=1).</td>
</tr>
<tr class="row-odd"><td>‘linear’</td>
<td>Use degree-1 polynomials (extrapolate=2).</td>
</tr>
<tr class="row-even"><td>‘quadratic’</td>
<td>Use degree-2 polynomials (extrapolate=3).</td>
</tr>
<tr class="row-odd"><td>‘cubic’</td>
<td>Use degree-3 polynomials (extrapolate=4).</td>
</tr>
<tr class="row-even"><td>‘spline’</td>
<td>Use all degree polynomials.</td>
</tr>
<tr class="row-odd"><td>‘off’</td>
<td>Return NaN outside model bounds (extrapolate=0).</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Array containing the coefficients.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.BaseModel.synth_values">
<code class="descname">synth_values</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>deriv=None</em>, <em>grid=None</em>, <em>extrapolate=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#BaseModel.synth_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.BaseModel.synth_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute magnetic field components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (None defaults to 0). For secular variation,
choose <code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid.
Arrays <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> must have one dimension less than the
output grid since the grid will be created as their outer product.</p>
</dd>
<dt><strong>extrapolate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘linear’, ‘quadratic’, ‘cubic’, ‘spline’, ‘constant’, ‘off’} or int, optional</span></dt>
<dd><p class="first last">Extrapolate to times outside of the model bounds. Specify
polynomial degree as string or any order as integer. Defaults to
<code class="docutils literal notranslate"><span class="pre">'linear'</span></code> (equiv. to order 2 polynomials).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chaos.CHAOS">
<em class="property">class </em><code class="descclassname">chaos.</code><code class="descname">CHAOS</code><span class="sig-paren">(</span><em>breaks</em>, <em>order=None</em>, <em>*</em>, <em>coeffs_tdep=None</em>, <em>coeffs_static=None</em>, <em>coeffs_sm=None</em>, <em>coeffs_gsm=None</em>, <em>breaks_delta=None</em>, <em>coeffs_delta=None</em>, <em>breaks_euler=None</em>, <em>coeffs_euler=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for the time-dependent geomagnetic field model CHAOS. Only
CHAOS-6 is currently supported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">Break points for piecewise-polynomial representation of the
time-dependent internal (i.e. large-scale core) field in modified
Julian date format.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of polynomial pieces (e.g. 4 = cubic) of the time-dependent
internal field.</p>
</dd>
<dt><strong>coeffs_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<cite>k</cite>, <cite>m</cite>, <code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_tdep</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent internal field as piecewise
polynomial.</p>
</dd>
<dt><strong>coeffs_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,  shape (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_static</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static internal (i.e. small-scale crustal) field.</p>
</dd>
<dt><strong>coeffs_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static external field in SM coordinates.</p>
</dd>
<dt><strong>coeffs_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static external field in GSM coordinates.</p>
</dd>
<dt><strong>breaks_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span> + 1,)</span></dt>
<dd><p class="first last">Breaks of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>coeffs_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span>,)</span></dt>
<dd><p class="first last">Coefficients of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>breaks_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_e\)</span> + 1,)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and corresponding break
vectors of Euler angles (keys are <code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
<dt><strong>coeffs_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (1, <span class="math notranslate nohighlight">\(m_e\)</span>, 3)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and arrays of the Euler
angles alpha, beta and gamma as trailing dimension (keys are
<code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create a time-dependent internal field model as a piecewise polynomial of
order 4 (i.e. cubic) having 10 pieces, spanning the first 50 days in the
year 2000 (breaks in modified Julian date 2000). As example, choose random
coefficients for the time-dependent field of spherical harmonic degree 1
(= 3 coefficients).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># define model</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of pieces</span>
<span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># polynomial order</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># create CHAOS class instance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">CHAOS</span><span class="p">(</span><span class="n">breaks</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">coeffs_tdep</span><span class="o">=</span><span class="n">coeffs</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, plot for example the field map on January 2, 2000 0:00 UTC</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">plot_maps_tdep</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">6371.2</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the Gauss coefficients of the time-dependent field in shc-format to
the current working directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_shcfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7_tdep.shc&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;tdep&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>timestamp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">UTC timestamp at initialization.</p>
</dd>
<dt><strong>model_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#chaos.BaseModel" title="chaos.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a> instance</span></dt>
<dd><p class="first last">Time-dependent internal field model.</p>
</dd>
<dt><strong>model_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticModel</span></code> instance</span></dt>
<dd><p class="first last">Static internal field model.</p>
</dd>
<dt><strong>n_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of external field in SM coordinates.</p>
</dd>
<dt><strong>coeffs_sm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_sm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of static external field in SM coordinates.</p>
</dd>
<dt><strong>n_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of external field in GSM coordinates.</p>
</dd>
<dt><strong>coeffs_gsm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> * (<code class="docutils literal notranslate"><span class="pre">n_gsm</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of static external field in GSM coordinates.</p>
</dd>
<dt><strong>breaks_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span> +1,)</span></dt>
<dd><p class="first last">Breaks of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>coeffs_delta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_q\)</span>,)</span></dt>
<dd><p class="first last">Coefficients of baseline corrections of static external field in SM
coordinates. The dictionary keys are <code class="docutils literal notranslate"><span class="pre">'q10'</span></code>, <code class="docutils literal notranslate"><span class="pre">'q11'</span></code>, <code class="docutils literal notranslate"><span class="pre">'s11'</span></code>.</p>
</dd>
<dt><strong>breaks_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (<span class="math notranslate nohighlight">\(m_e\)</span> +1,)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and corresponding break
vectors of Euler angles (CHAOS-6: keys are <code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
<dt><strong>coeffs_euler</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict with ndarrays, shape (1, <span class="math notranslate nohighlight">\(m_e\)</span>, 3)</span></dt>
<dd><p class="first last">Dictionary containing satellite name as key and arrays of the Euler
angles alpha, beta and gamma as trailing dimension (CHAOS-6: keys are
<code class="docutils literal notranslate"><span class="pre">'oersted'</span></code>, <code class="docutils literal notranslate"><span class="pre">'champ'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sac_c'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_a'</span></code>, <code class="docutils literal notranslate"><span class="pre">'swarm_b'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'swarm_c'</span></code>).</p>
</dd>
<dt><strong>version</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Version specifier (<code class="docutils literal notranslate"><span class="pre">None</span></code> evaluates to
<code class="docutils literal notranslate"><span class="pre">basicConfig['params.version']</span></code> by default).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chaos.CHAOS.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>source_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnetic field from the CHAOS model using all sources
(time-dependent and static internal field, and external SM/GSM
fields including induced parts).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>source_list</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list, [‘tdep’, ‘static’, ‘gsm’, ‘sm’]</span></dt>
<dd><p class="first last">Specify sources in any order. Default is all sources.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (grid_shape)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Print model version and initialization timestamp.</p>
</dd></dl>

<dl class="classmethod">
<dt id="chaos.CHAOS.from_mat">
<em class="property">classmethod </em><code class="descname">from_mat</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.from_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.from_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative constructor for creating a <a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> class instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to mat-file containing the CHAOS model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> instance</span></dt>
<dd><p class="first last">Fully initialized model.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.load_CHAOS_matfile" title="chaos.load_CHAOS_matfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_CHAOS_matfile</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<p>Load for example the mat-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7.mat</span></code> in the current working
directory like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chaosmagpy</span> <span class="kn">import</span> <span class="n">CHAOS</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CHAOS</span><span class="o">.</span><span class="n">from_mat</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7.mat&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="chaos.CHAOS.from_shc">
<em class="property">classmethod </em><code class="descname">from_shc</code><span class="sig-paren">(</span><em>filepath</em>, <em>*</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.from_shc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.from_shc" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative constructor for creating a <a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> class instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to shc-file.</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap year in time conversion into account (default).
Otherwise, use conversion factor of 365.25 days per year.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> instance</span></dt>
<dd><p class="first last">Class instance with either the time-dependent or static internal
part initialized.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.load_CHAOS_shcfile" title="chaos.load_CHAOS_shcfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_CHAOS_shcfile</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<p>Load for example the shc-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7_tdep.shc</span></code> in the current
working directory, containing the coefficients of time-dependent
internal part of the CHAOS-6-x7 model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">CHAOS</span><span class="o">.</span><span class="n">from_shc</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7_tdep.shc&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_maps_external">
<code class="descname">plot_maps_external</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>*</em>, <em>nmax=None</em>, <em>reference=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.plot_maps_external"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.plot_maps_external" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the external field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘GSM’, ‘SM’}, optional</span></dt>
<dd><p class="first last">Choose contribution either from GSM, SM or both added
(default is ‘all’).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source to be external (inducing), internal (induced) or
both added (default is ‘all’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_maps_static">
<code class="descname">plot_maps_static</code><span class="sig-paren">(</span><em>radius</em>, <em>*</em>, <em>nmax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.plot_maps_static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.plot_maps_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the static internal field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options are passed to <a class="reference internal" href="#chaos.BaseModel.plot_maps" title="chaos.BaseModel.plot_maps"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.plot_maps()</span></code></a>
method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_maps_tdep">
<code class="descname">plot_maps_tdep</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>*</em>, <em>nmax=None</em>, <em>deriv=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.plot_maps_tdep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.plot_maps_tdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot global map of the time-dependent internal field from the CHAOS
model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options are passed to <a class="reference internal" href="#chaos.BaseModel.plot_maps" title="chaos.BaseModel.plot_maps"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.plot_maps()</span></code></a> method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Global map of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.plot_timeseries_tdep">
<code class="descname">plot_timeseries_tdep</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.plot_timeseries_tdep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.plot_timeseries_tdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time series of the time-dependent internal field from the
CHAOS model at a specific location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (), (1,) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative in time (default is 0). For secular variation, choose
<code class="docutils literal notranslate"><span class="pre">deriv=1</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to <a class="reference internal" href="#chaos.BaseModel.plot_timeseries" title="chaos.BaseModel.plot_timeseries"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.plot_timeseries()</span></code></a>
method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong></dt>
<dd><p class="first last">Time series plot of the radial, colatitude and azimuthal field
components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.save_matfile">
<code class="descname">save_matfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.save_matfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.save_matfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save CHAOS model to <cite>mat</cite>-format. The model must be fully specified as
is the case if originally loaded from a <cite>mat</cite>-file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path and name of <cite>mat</cite>-formatted file that is to be saved.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.save_shcfile">
<code class="descname">save_shcfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>*</em>, <em>model=None</em>, <em>deriv=None</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.save_shcfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.save_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save spherical harmonic coefficients to a file in <cite>shc</cite>-format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path and name of output file <cite>*.shc</cite>.</p>
</dd>
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘tdep’, ‘static’}, optional</span></dt>
<dd><p class="first last">Choose part of the model to save (default is ‘tdep’).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Derivative of the time-dependent field (default is 0, ignored for
static source).</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap years for decimal year conversion into account
(defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_coeffs_gsm">
<code class="descname">synth_coeffs_gsm</code><span class="sig-paren">(</span><em>time</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_coeffs_gsm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_coeffs_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the external GSM field coefficients from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source either external or internal (default is ‘external’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the external GSM field in term of geographic
coordinates (GEO).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_coeffs_sm">
<code class="descname">synth_coeffs_sm</code><span class="sig-paren">(</span><em>time</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_coeffs_sm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_coeffs_sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the external SM field from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source either external or internal (default is ‘external’).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the external SM field coefficients in terms of
geographic coordinates (GEO).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_coeffs_static">
<code class="descname">synth_coeffs_static</code><span class="sig-paren">(</span><em>*</em>, <em>nmax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_coeffs_static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_coeffs_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the static internal field coefficients from the CHAOS model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options are passed to <a class="reference internal" href="#chaos.BaseModel.synth_coeffs" title="chaos.BaseModel.synth_coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.synth_coeffs()</span></code></a>
method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2),)</span></dt>
<dd><p class="first last">Coefficients of the static internal field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_coeffs_tdep">
<code class="descname">synth_coeffs_tdep</code><span class="sig-paren">(</span><em>time</em>, <em>*</em>, <em>nmax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_coeffs_tdep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_coeffs_tdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the time-dependent internal field coefficients from the CHAOS
model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the time in modified Julian dates.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to <a class="reference internal" href="#chaos.BaseModel.synth_coeffs" title="chaos.BaseModel.synth_coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.synth_coeffs()</span></code></a>
method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Coefficients of the time-dependent internal field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_euler_angles">
<code class="descname">synth_euler_angles</code><span class="sig-paren">(</span><em>time</em>, <em>satellite</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_euler_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_euler_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract Euler angles for specified satellite.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>satellite</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Satellite from which to get the euler angles.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>angles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">Euler angles alpha, beta and gamma in degrees, stored in trailing
dimension.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_values_gsm">
<code class="descname">synth_values_gsm</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_values_gsm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_values_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute GSM magnetic field components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source to be external (inducing), internal (induced) or
both added (default to ‘all’).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid,
which is created from <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> as their outer product
(defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_values_sm">
<code class="descname">synth_values_sm</code><span class="sig-paren">(</span><em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_values_sm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_values_sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute SM magnetic field components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as MJD2000 (modified Julian date).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘all’, ‘external’, ‘internal’}, optional</span></dt>
<dd><p class="first last">Choose source to be external (inducing), internal (induced) or
both added (default to ‘all’).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid,
which is created from <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> as their outer product
(defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_values_static">
<code class="descname">synth_values_static</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_values_static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_values_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute magnetic field components of the internal static field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Radius of station in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by the model
coefficients, but can also be smaller, if specified).</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options are passed to <a class="reference internal" href="#chaos.BaseModel.synth_values" title="chaos.BaseModel.synth_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.synth_values()</span></code></a>
method.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chaos.CHAOS.synth_values_tdep">
<code class="descname">synth_values_tdep</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#CHAOS.synth_values_tdep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.CHAOS.synth_values_tdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method for computing magnetic components of the internal
time-dependent field. See <a class="reference internal" href="#chaos.BaseModel.synth_values" title="chaos.BaseModel.synth_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseModel.synth_values()</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="chaos.load_CHAOS_matfile">
<code class="descclassname">chaos.</code><code class="descname">load_CHAOS_matfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#load_CHAOS_matfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.load_CHAOS_matfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CHAOS model from mat-file, e.g. <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7.mat</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to mat-file containing the CHAOS model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> instance</span></dt>
<dd><p class="first last">Fully initialized model.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CHAOS</span></code></a>, <a class="reference internal" href="#chaos.load_CHAOS_shcfile" title="chaos.load_CHAOS_shcfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_CHAOS_shcfile</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<p>Load for example the mat-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7.mat</span></code> in the current working
directory like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">load_CHAOS_matfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7.mat&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chaos.load_CHAOS_shcfile">
<code class="descclassname">chaos.</code><code class="descname">load_CHAOS_shcfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chaos.html#load_CHAOS_shcfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chaos.load_CHAOS_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load CHAOS model from shc-file, e.g. <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7_tdep.shc</span></code>. The file
should contain the coefficients of the time-dependent or static internal
part of the CHAOS model. In case of the time-dependent part, a
reconstruction of the piecewise polynomial is performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Path to shc-file.</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap year in time conversion into account (default). Otherwise,
use conversion factor of 365.25 days per year.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-class docutils literal notranslate"><span class="pre">CHAOS</span></code></a> instance</span></dt>
<dd><p class="first last">Class instance with either the time-dependent or static internal part
initialized.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#chaos.CHAOS" title="chaos.CHAOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CHAOS</span></code></a>, <a class="reference internal" href="#chaos.load_CHAOS_matfile" title="chaos.load_CHAOS_matfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_CHAOS_matfile</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<p>Load for example the shc-file <code class="docutils literal notranslate"><span class="pre">CHAOS-6-x7_tdep.shc</span></code> in the current
working directory, containing the coefficients of time-dependent internal
part of the CHAOS-6-x7 model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy</span> <span class="kn">as</span> <span class="nn">cp</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">load_CHAOS_shcfile</span><span class="p">(</span><span class="s1">&#39;CHAOS-6-x7_tdep.shc&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="additional-functionality">
<h2>Additional functionality<a class="headerlink" href="#additional-functionality" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-coordinate_utils">
<span id="coordinate-transformations-coordinate-utils"></span><h3>Coordinate transformations (<cite>coordinate_utils</cite>)<a class="headerlink" href="#module-coordinate_utils" title="Permalink to this headline">¶</a></h3>
<p>Functions for coordinate transformations.</p>
<p>Abbreviations :</p>
<dl class="docutils">
<dt>GEO <span class="classifier-delimiter">:</span> <span class="classifier">geocentric, orthogonal coordinate system</span></dt>
<dd>With z-axis along Earth’s rotation axis, x-axis pointing to Greenwich and
y-axis completing right-handed coordinate system.</dd>
<dt>USE <span class="classifier-delimiter">:</span> <span class="classifier">local orthogonal coordinate system on spherical surface</span></dt>
<dd>Axes directions are defined as Up-South-East (e.g. B_radius, B_theta,
B_phi in GEO).</dd>
<dt>GSM <span class="classifier-delimiter">:</span> <span class="classifier">geocentric solar magnetic, orthogonal coordinate system</span></dt>
<dd>With x-axis pointing towards the sun, y-axis perpendicular to plane spanned
by Eart-Sun line and dipole axis and z-axis completing right-handed system.</dd>
<dt>SM <span class="classifier-delimiter">:</span> <span class="classifier">solar magnetic, orthogonal coordinate system</span></dt>
<dd>With z-axis along dipole axis pointing to the geomagnetic North pole,
y-axis perpendicular to plane containing the dipole axis and the Earth-Sun
line, and x-axis completing the right-handed system.</dd>
<dt>MAG <span class="classifier-delimiter">:</span> <span class="classifier">magnetic orthogonal coordinate system (centered dipole)</span></dt>
<dd>With z-axis pointing to the geomagnetic North pole, x-axis in the plane
spanned by the dipole axis and Earth’s rotation axis, and y-axis completing
the right-handed system.</dd>
</dl>
<dl class="function">
<dt id="coordinate_utils.basevectors_gsm">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_gsm</code><span class="sig-paren">(</span><em>time</em>, <em>dipole=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#basevectors_gsm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.basevectors_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the gsm coordinate system with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,), optional</span></dt>
<dd><p class="first last">Dipole spherical harmonics <span class="math notranslate nohighlight">\(g_1^0\)</span>, <span class="math notranslate nohighlight">\(g_1^1\)</span> and
<span class="math notranslate nohighlight">\(h_1^1\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>gsm_1, gsm_2, gsm_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">GSM unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">time</span></code>, while the last dimension contains the unit vector
components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_mag">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_mag</code><span class="sig-paren">(</span><em>dipole=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#basevectors_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.basevectors_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the central-dipole coordinate system
(sometimes referred to as MAG). The components are given with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,), optional</span></dt>
<dd><p class="first last">Dipole spherical harmonics <span class="math notranslate nohighlight">\(g_1^0\)</span>, <span class="math notranslate nohighlight">\(g_1^1\)</span> and
<span class="math notranslate nohighlight">\(h_1^1\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_1, mag_2, mag_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,)</span></dt>
<dd><p class="first last">MAG unit base vectors.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_sm">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_sm</code><span class="sig-paren">(</span><em>time</em>, <em>dipole=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#basevectors_sm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.basevectors_sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of the sm coordinate system with respect to
the geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,), optional</span></dt>
<dd><p class="first last">Dipole spherical harmonics <span class="math notranslate nohighlight">\(g_1^0\)</span>, <span class="math notranslate nohighlight">\(g_1^1\)</span> and
<span class="math notranslate nohighlight">\(h_1^1\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sm_1, sm_2, sm_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">SM unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">time</span></code>, while the last dimension contains the unit vector
components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.basevectors_use">
<code class="descclassname">coordinate_utils.</code><code class="descname">basevectors_use</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#basevectors_use"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.basevectors_use" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the unit base vectors of local orthogonal coordinate system USE
(Up-South-East) on spherical surface (theta, phi) with respect to the
geocentric coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees <span class="math notranslate nohighlight">\((0^\circ, 180^\circ)\)</span>, i.e.
exclude poles.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>use_1, use_2, use_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">USE unit base vectors. The leading dimension agrees with the shape of
<code class="docutils literal notranslate"><span class="pre">theta</span></code> or <code class="docutils literal notranslate"><span class="pre">phi</span></code>, while the last dimension contains the unit
vector components in terms of the geocentric coordinate system.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.cartesian_to_spherical">
<code class="descclassname">coordinate_utils.</code><code class="descname">cartesian_to_spherical</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#cartesian_to_spherical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.cartesian_to_spherical" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geocentric cartesian to spherical coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x, y, z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric radius.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ,180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.center_azimuth">
<code class="descclassname">coordinate_utils.</code><code class="descname">center_azimuth</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#center_azimuth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.center_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Project arbitrary azimuth angles in degrees to semi-open interval
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.conducting_sphere">
<code class="descclassname">coordinate_utils.</code><code class="descname">conducting_sphere</code><span class="sig-paren">(</span><em>periods</em>, <em>sigma</em>, <em>radius</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#conducting_sphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.conducting_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Computation of the response for a spherically layered conductor in an
inducing external field of a single spherical degree.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>periods</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray or float, shape (…,)</span></dt>
<dd><p class="first last">Oscillation period of the inducing field in seconds.</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nl,)</span></dt>
<dd><p class="first last">Conductivity of spherical shells, starting with the outermost and
excluding the perfectly conducting innermost sphere in (S/m).</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nl+1,)</span></dt>
<dd><p class="first last">Radius of the interfaces in between the layers, starting with outermost
layer in kilometers (i.e. conductor surface, see Notes).</p>
</dd>
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Spherical degree of inducing external field.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>C</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">C-response, complex.</p>
</dd>
<dt><strong>rho_a</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Electrical surface resistance in (<span class="math notranslate nohighlight">\(\Omega m\)</span>).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Proportional to phase angle of response in degrees.</p>
</dd>
<dt><strong>Q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…,)</span></dt>
<dd><p class="first last">Q-response, complex.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The following applies to the layered conductivity shells:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[0]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[1]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[0]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[1]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[2]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[1]</span></code></div>
<div class="line">…</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[nl-1]</span></code> &gt; <cite>r</cite> &gt; <code class="docutils literal notranslate"><span class="pre">radius[nl]</span></code> : <code class="docutils literal notranslate"><span class="pre">sigma[nl-1]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">radius[nl+1]</span></code> &gt; <cite>r</cite> &gt; 0 :      <span class="math notranslate nohighlight">\(\sigma\)</span> = <cite>inf</cite></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nl</span></code> is number of uniform layers (excluding a perfectly conducting core),
radius in km, conductivity <span class="math notranslate nohighlight">\(\sigma\)</span> in (S/m)</p>
<p>The program should work also for very small periods, where it
models the response of a layered plane conductor</p>
<div class="line-block">
<div class="line">Python version: August 2018, Clemens Kloss</div>
<div class="line">Matlab version: November 2000, Nils Olsen</div>
<div class="line">Original Fortran program: Peter Weidelt</div>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.geo_to_base">
<code class="descclassname">coordinate_utils.</code><code class="descname">geo_to_base</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#geo_to_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.geo_to_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms spherical geographic coordinates into spherical coordinates of a
rotated reference system as given by three base vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,) or (…, 3)</span></dt>
<dd><p class="first last">Base vector 1 through 3 having components with respect to GEO.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated to
geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.transform_points" title="coordinate_utils.transform_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_points</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.igrf_dipole">
<code class="descclassname">coordinate_utils.</code><code class="descname">igrf_dipole</code><span class="sig-paren">(</span><em>epoch=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#igrf_dipole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.igrf_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit vector that is anti-parallel to the IGRF dipole, i.e. pointing towards
the geomagnetic North pole (located in the Northern Hemisphere). Epoch 2015
of IGRF-12 is used by default.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epoch</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘2015’, ‘2010’}, optional</span></dt>
<dd><p class="first last">Epoch of IGRF-12 (2015) and IGRF-11 (2010, default).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,)</span></dt>
<dd><p class="first last">Unit vector pointing to geomagnetic North pole (located in Northern
Hemisphere).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.matrix_geo_to_base">
<code class="descclassname">coordinate_utils.</code><code class="descname">matrix_geo_to_base</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#matrix_geo_to_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.matrix_geo_to_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrix to rotate vectors from USE frame at spherical geographic
coordinates (theta, phi) to USE frame at spherical reference coordinates
defined by a set of base vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longtiude in degrees.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">Base vectors 1 through 3 as columns with respect to GEO.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Reference longitude in degrees <span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3, 3), optional</span></dt>
<dd><p class="first">Array of matrices that rotates vectors B in spherical GEO to the target
spherical reference. The matrices (3x3) reside in the last two
dimensions, while the leading dimensions are identical to the input
grid.</p>
<div class="last line-block">
<div class="line">B_radius_ref = B_radius</div>
<div class="line">B_theta_ref  = R[1, 1]*B_theta + R[1, 2]*B_phi</div>
<div class="line">B_phi_ref    = R[2, 1]*B_theta + R[2, 2]*B_phi</div>
</div>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.transform_vectors" title="coordinate_utils.transform_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_vectors</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.q_response">
<code class="descclassname">coordinate_utils.</code><code class="descname">q_response</code><span class="sig-paren">(</span><em>frequency</em>, <em>nmax</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#q_response"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.q_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Q-response given a conductivity model of Earth, which is
loaded during the computation (from
<code class="docutils literal notranslate"><span class="pre">basicConfig['file.Earth_conductivity']</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>frequency</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Vector of N frequencies (1/sec) for which to compute Q-response.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum spherical harmonic degree of inducing field.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q_response</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nmax, N)</span></dt>
<dd><p class="first last">Q-response for every frequency and harmonic degree of inducing
field. Index 0 corresponds to degree 1, index 1 corresponds to degree
2, and so on.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.rotate_gauss">
<code class="descclassname">coordinate_utils.</code><code class="descname">rotate_gauss</code><span class="sig-paren">(</span><em>nmax</em>, <em>kmax</em>, <em>base_1</em>, <em>base_2</em>, <em>base_3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#rotate_gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.rotate_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix to transform spherical harmonic expansion given with
respect to a rotated coordinate system to the standard geographic
reference (GEO). The rotated coordinate system is described by 3 orthogonal
base vectors with components in GEO coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to
geographic reference (target reference system).</p>
</dd>
<dt><strong>kmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to rotated
reference system.</p>
</dd>
<dt><strong>base_1, base_2, base_3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, 3)</span></dt>
<dd><p class="first last">Base vectors of rotated reference system given in terms of the
target reference system. Vectors reside in the last dimension.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>matrix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first">Matrices reside in last two dimensions. They transform spherical
harmonic coefficients of rotated reference (e.g. GSM) to standard
geographic reference (GEO):</p>
<p class="last">[g10 g11 h11 …]_geo = M * [g10 g11 h11 …]_gsm</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.rotate_gauss_fft">
<code class="descclassname">coordinate_utils.</code><code class="descname">rotate_gauss_fft</code><span class="sig-paren">(</span><em>nmax</em>, <em>kmax</em>, <em>*</em>, <em>step=None</em>, <em>N=None</em>, <em>filter=None</em>, <em>save_to=None</em>, <em>reference=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#rotate_gauss_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.rotate_gauss_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Fourier components of the timeseries of matrices that transform
spherical harmonic expansions (degree <code class="docutils literal notranslate"><span class="pre">kmax</span></code>) from a time-dependent
reference system (e.g. GSM, SM) to GEO (degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to
geographic reference (target reference system).</p>
</dd>
<dt><strong>kmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Maximum degree of spherical harmonic expansion with respect to rotated
reference system.</p>
</dd>
<dt><strong>step</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Sample spacing given in hours (default is 1.0 hour).</p>
</dd>
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of samples for which to evaluate the FFT (default is
N = 8*365.25*24 equiv. to 8 years using default sample spacing).</p>
</dd>
<dt><strong>filter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Set filter length, i.e. number of Fourier components to be saved
(default is <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p>
</dd>
<dt><strong>save_to</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Path and file name to store output in npz-format. Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>, i.e. no file is written.</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’}, optional</span></dt>
<dd><p class="first last">Time-dependent reference system (default is GSM).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>frequency, frequency_ind</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">filter</span></code>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first last">Unsorted vector of positive frequencies in 1/days.</p>
</dd>
<dt><strong>spectrum, spectrum_ind</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (<code class="docutils literal notranslate"><span class="pre">filter</span></code>, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2), <code class="docutils literal notranslate"><span class="pre">kmax</span></code> (<code class="docutils literal notranslate"><span class="pre">kmax</span></code> + 2))</span></dt>
<dd><p class="first last">Complex fourier spectrum of rotation matrices to transform spherical
harmonic expansions. It also uses a conductivity model to derive the
transform for the induced field.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <code class="docutils literal notranslate"><span class="pre">save_to=&lt;filepath&gt;</span></code>, then an <code class="docutils literal notranslate"><span class="pre">*.npz</span></code>-file is written with the
keywords {‘frequency’, ‘spectrum’, ‘frequency_ind’, ‘spectrum_ind’,
‘step’, ‘N’, ‘filter’, ‘reference’, ‘dipole’}. <code class="docutils literal notranslate"><span class="pre">'dipole'</span></code> means the three
spherical harmonic coefficients of the dipole set in
<code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.spherical_to_cartesian">
<code class="descclassname">coordinate_utils.</code><code class="descname">spherical_to_cartesian</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#spherical_to_cartesian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.spherical_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geocentric spherical to cartesian coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric radius.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x, y, z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape(…)</span></dt>
<dd><p class="first last">Cartesian coordinates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.sun_position">
<code class="descclassname">coordinate_utils.</code><code class="descname">sun_position</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#sun_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.sun_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the sun’s position in longitude and colatitude given time
(mjd2000). It is accurate for years 1901 through 2099, to within 0.006 deg.
Input shape is preserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude of sun’s position in degrees
<span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric east longtiude of sun’s position in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Taken from <a class="reference external" href="http://jsoc.stanford.edu/doc/keywords/Chris_Russel/Geophysical%20Coordinate%20Transformations.htm#appendix2">here</a></p>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.synth_rotate_gauss">
<code class="descclassname">coordinate_utils.</code><code class="descname">synth_rotate_gauss</code><span class="sig-paren">(</span><em>time</em>, <em>frequency</em>, <em>spectrum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#synth_rotate_gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.synth_rotate_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrices to transform sphercial harmonic expansion from
time-dependent reference system (e.g. GSM, SM) to GEO based on Fourier
components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000).</p>
</dd>
<dt><strong>frequency</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k,) or (k, m, n)</span></dt>
<dd><p class="first last">Vector of frequencies given in oscillations per day.</p>
</dd>
<dt><strong>spectrum</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k, m, n)</span></dt>
<dd><p class="first last">Fourier components of the matrices (reside in the last two dimensions).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>matrix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, m, n)</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.transform_points">
<code class="descclassname">coordinate_utils.</code><code class="descname">transform_points</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>time=None</em>, <em>*</em>, <em>reference=None</em>, <em>inverse=False</em>, <em>dipole=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#transform_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.transform_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms spherical geographic coordinates into spherical coordinates of
the target coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longtiude in degrees.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000). Ignored for <code class="docutils literal notranslate"><span class="pre">reference='mag'</span></code>.</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’, ‘mag’}</span></dt>
<dd><p class="first last">Target coordinate system for points provided in GEO</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,), optional</span></dt>
<dd><p class="first last">Dipole spherical harmonics <span class="math notranslate nohighlight">\(g_1^0\)</span>, <span class="math notranslate nohighlight">\(g_1^1\)</span> and
<span class="math notranslate nohighlight">\(h_1^1\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference longitude in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.geo_to_base" title="coordinate_utils.geo_to_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geo_to_base</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="coordinate_utils.transform_vectors">
<code class="descclassname">coordinate_utils.</code><code class="descname">transform_vectors</code><span class="sig-paren">(</span><em>theta</em>, <em>phi</em>, <em>B_theta</em>, <em>B_phi</em>, <em>time=None</em>, <em>reference=None</em>, <em>inverse=False</em>, <em>dipole=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coordinate_utils.html#transform_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coordinate_utils.transform_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms vectors with components in USE (Up-South-East) at
spherical geographic coordinates (theta, phi) to components in USE at the
sphercial coordinates of the rotated target coordinate system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric colatitude in degrees.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Geocentric longitude in degrees.</p>
</dd>
<dt><strong>B_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude vector components.</p>
</dd>
<dt><strong>B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Azimuthal vector components.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Time given as modified Julian date, i.e. with respect to the date 0h00
January 1, 2000 (mjd2000). Ignored for <code class="docutils literal notranslate"><span class="pre">reference='mag'</span></code>.</p>
</dd>
<dt><strong>reference</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘gsm’, ‘sm’, ‘mag’}</span></dt>
<dd><p class="first last">Target coordinate system.</p>
</dd>
<dt><strong>inverse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Use inverse transformation instead, i.e. transform from rotated
coordinates to geographic (default is False).</p>
</dd>
<dt><strong>dipole</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (3,), optional</span></dt>
<dd><p class="first last">Dipole spherical harmonics <span class="math notranslate nohighlight">\(g_1^0\)</span>, <span class="math notranslate nohighlight">\(g_1^1\)</span> and
<span class="math notranslate nohighlight">\(h_1^1\)</span>. Defaults to <code class="docutils literal notranslate"><span class="pre">basicConfig['params.dipole']</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Target reference longitude in degrees
<span class="math notranslate nohighlight">\((-180^\circ, 180^\circ]\)</span>.</p>
</dd>
<dt><strong>B_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude vector components in the target reference.</p>
</dd>
<dt><strong>B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Azimuthal vector components in the target reference.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#coordinate_utils.matrix_geo_to_base" title="coordinate_utils.matrix_geo_to_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix_geo_to_base</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-model_utils">
<span id="model-utilities-model-utils"></span><h3>Model utilities (<cite>model_utils</cite>)<a class="headerlink" href="#module-model_utils" title="Permalink to this headline">¶</a></h3>
<p>Functions for building the CHAOS model.</p>
<dl class="function">
<dt id="model_utils.augment_breaks">
<code class="descclassname">model_utils.</code><code class="descname">augment_breaks</code><span class="sig-paren">(</span><em>breaks</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#augment_breaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.augment_breaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Augment a vector of break points and return the knot vector for a
B-spline representation of order <cite>k</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>breaks: ndarray, shape (n,)</strong></dt>
<dd><p class="first last">1-D array, containing <cite>n</cite> break points (without endpoint repeats).</p>
</dd>
<dt><strong>order: int, positive</strong></dt>
<dd><p class="first last">Order <cite>k</cite> of B-spline (4 = cubic).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>knots: ndarray, shape (n+2k-2,)</strong></dt>
<dd><p class="first last">1-D array with <cite>k</cite>-times repeated copies of the <cite>breaks</cite>-vector
endpoints <code class="docutils literal notranslate"><span class="pre">breaks[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">breaks[-1]</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.colloc_matrix">
<code class="descclassname">model_utils.</code><code class="descname">colloc_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>knots</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#colloc_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.colloc_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create collocation matrix of a univariate function on <cite>x</cite> in terms  of a
B-spline representation of order <cite>k</cite>. The computation of the splines is
based on the scipy-package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last"><cite>N</cite> points to evaluate the B-spline at.</p>
</dd>
<dt><strong>knots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape &gt;= (k+1,)</span></dt>
<dd><p class="first last">Vector of knots derived from breaks (with appropriate endpoint
multiplicity).</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of the B-spline (4 = cubic).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>collmat</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, n-k)</span></dt>
<dd><p class="first last">Collocation matrix, <cite>n</cite> is the size of <cite>knots</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.augment_breaks" title="model_utils.augment_breaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">augment_breaks</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.degree_correlation">
<code class="descclassname">model_utils.</code><code class="descname">degree_correlation</code><span class="sig-paren">(</span><em>coeffs_1</em>, <em>coeffs_2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#degree_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.degree_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlation per spherical harmonic degree between two models 1 and 2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coeffs_1, coeffs_2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Two sets of coefficients of equal length <cite>N</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>C_n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nmax,)</span></dt>
<dd><p class="first last">Degree correlation of the two models. There are <cite>N = nmax(nmax+2)</cite>
coefficients.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.design_gauss">
<code class="descclassname">model_utils.</code><code class="descname">design_gauss</code><span class="sig-paren">(</span><em>radius</em>, <em>theta</em>, <em>phi</em>, <em>nmax</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#design_gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.design_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrices to connect the radial, colatitude and azimuthal field
components to the magnetic potential field in terms of spherical harmonic
coefficients (Schmidt quasi-normalized).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the radius of <cite>N</cite> data points in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the sphercial harmonic expansion.</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>A_radius, A_theta, A_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, <code class="docutils literal notranslate"><span class="pre">nmax</span></code> * (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2))</span></dt>
<dd><p class="first last">Matrices for radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.design_matrix">
<code class="descclassname">model_utils.</code><code class="descname">design_matrix</code><span class="sig-paren">(</span><em>knots</em>, <em>order</em>, <em>n_tdep</em>, <em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>n_static=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#design_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.design_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matrices that connect radial, colatitude and azimuthal field
components on a grid with <cite>radius</cite>, <cite>theta</cite> (colatitude) and <cite>phi</cite>
with the spherical harmonics expansion of a potential. The potential is
time-dependent on large length-scales (<cite>n</cite> &lt;= <cite>n_tdep</cite>) and static on small
length-scales (<cite>n_tdep</cite> &lt; <cite>n</cite> &lt;= <cite>n_static</cite>). The time-dependent part uses
a B-spline representation of order <cite>k</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>knots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape &gt;= (k+1,)</span></dt>
<dd><p class="first last">Knot vector with adequate endpoint multiplicity.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of B-spline basis functions (4 = cubic).</p>
</dd>
<dt><strong>n_tdep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the time-dependent field.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Time vector of the <cite>N</cite> data points in days.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Radius vector of the <cite>N</cite> data points in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Data colatitude vector in degrees <span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Data longitude vector in degrees.</p>
</dd>
<dt><strong>n_static</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree of static field (default is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<cite>n_static</cite> &gt; <cite>n_tdep</cite>).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is internal).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>G_radius, G_theta, G_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, …)</span></dt>
<dd><p class="first last">Forward matrix for <span class="math notranslate nohighlight">\(B_r\)</span>, <span class="math notranslate nohighlight">\(B_{\theta}\)</span> and
<span class="math notranslate nohighlight">\(B_{\phi}\)</span>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">If degree of static field is smaller than the degree of the time-dep.
field. In order to exclude the static field and obtain a purely
time-dependent potential, use optional argument <code class="docutils literal notranslate"><span class="pre">n_static=None</span></code> or
leave out completely.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.design_gauss" title="model_utils.design_gauss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">design_gauss</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.legendre_poly">
<code class="descclassname">model_utils.</code><code class="descname">legendre_poly</code><span class="sig-paren">(</span><em>nmax</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#legendre_poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.legendre_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns associated Legendre polynomials <cite>P(n,m)</cite> (Schmidt quasi-normalized)
and the derivative <cite>dP(n,m)</cite> vrt. <cite>theta</cite> evaluated at <cite>theta</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Maximum degree of the spherical expansion.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Colatitude in degrees <span class="math notranslate nohighlight">\([0^\circ, 180^\circ]\)</span>
of arbitrary shape.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Pnm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (n, m, …)</span></dt>
<dd><p class="first last">Evaluated values and derivatives, grid shape is appended as trailing
dimensions. <cite>P(n,m)</cite> := <code class="docutils literal notranslate"><span class="pre">Pnm[n,</span> <span class="pre">m,</span> <span class="pre">...]</span></code> and <cite>dP(n,m)</cite> :=
<code class="docutils literal notranslate"><span class="pre">Pnm[m,</span> <span class="pre">n+1,</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.power_spectrum">
<code class="descclassname">model_utils.</code><code class="descname">power_spectrum</code><span class="sig-paren">(</span><em>coeffs</em>, <em>radius=None</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#power_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.power_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Mauersberger-Lowes spatial powerspectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, N*(N+2))</span></dt>
<dd><p class="first last">Spherical harmonic coefficients for degree <cite>N</cite>.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Radius in kilometers (defaults to mean Earth’s surface radius).</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Maximum sphercial degree (defaults to <cite>N</cite>).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}</span></dt>
<dd><p class="first last">Source of the field model (defaults to internal).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>R_n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>)</span></dt>
<dd><p class="first last">Power spectrum for degrees up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="model_utils.synth_from_pp">
<code class="descclassname">model_utils.</code><code class="descname">synth_from_pp</code><span class="sig-paren">(</span><em>breaks</em>, <em>order</em>, <em>coeffs</em>, <em>time</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>deriv=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#synth_from_pp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.synth_from_pp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute radial, colatitude and azimuthal field components from the magnetic
potential in terms of a spherical harmonic expansion in form of a
piecewise polynomial.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>breaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (m+1,)</span></dt>
<dd><p class="first last">1-D array, containing <cite>m+1</cite> break points (without endpoint repeats) for
<cite>m</cite> intervals.</p>
</dd>
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive</span></dt>
<dd><p class="first last">Order <cite>k</cite> of piecewise polynomials (4 = cubic).</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (k, m, nmax*(nmax+2))</span></dt>
<dd><p class="first last">Coefficients of the piecewise polynomials, where <cite>m</cite> is the number of
polynomial pieces. The trailing dimension is equal to the number of
expansion coefficients for each interval.</p>
</dd>
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the time in days.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…) or float</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree harmonic expansion (default is given by <code class="docutils literal notranslate"><span class="pre">coeffs</span></code>,
but can also be smaller, if specified).</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
<dt><strong>deriv</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Derivative to be taken (default is 0).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid. Arrays
<code class="docutils literal notranslate"><span class="pre">theta``and</span> <span class="pre">``phi</span></code> must have one dimension less than the output grid
since the grid will be created as their outer product.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#model_utils.synth_values" title="model_utils.synth_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synth_values</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="model_utils.synth_values">
<code class="descclassname">model_utils.</code><code class="descname">synth_values</code><span class="sig-paren">(</span><em>coeffs</em>, <em>radius</em>, <em>theta</em>, <em>phi</em>, <em>*</em>, <em>nmax=None</em>, <em>source=None</em>, <em>grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_utils.html#synth_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#model_utils.synth_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes radial, colatitude and azimuthal field components from the
magnetic potential field in terms of spherical harmonic coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…, N)</span></dt>
<dd><p class="first last">Coefficients of the spherical harmonic expansion. The last dimension is
equal to the number of coefficients, <cite>N</cite> at the grid points.</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray, shape (…)</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, positive, optional</span></dt>
<dd><p class="first last">Maximum degree up to which expansion is to be used (default is given by
the <code class="docutils literal notranslate"><span class="pre">coeffs</span></code>, but can also be smaller if specified
<span class="math notranslate nohighlight">\(N\)</span> <span class="math notranslate nohighlight">\(\geq\)</span> <code class="docutils literal notranslate"><span class="pre">nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">nmax</span></code> + 2)</p>
</dd>
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘internal’, ‘external’}, optional</span></dt>
<dd><p class="first last">Magnetic field source (default is an internal source).</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, field components are computed on a regular grid. Arrays
<code class="docutils literal notranslate"><span class="pre">theta``and</span> <span class="pre">``phi</span></code> must have one dimension less than the output grid
since the grid will be created as their outer product (defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B_radius, B_theta, B_phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (…)</span></dt>
<dd><p class="first last">Radial, colatitude and azimuthal field components.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The function can work with different grid shapes, but the inputs have to
satisfy NumPy’s <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.15.0/user/basics.broadcasting.html">broadcasting rules</a>
(<code class="docutils literal notranslate"><span class="pre">grid=False</span></code>, default). This also applies to the dimension of the
coefficients <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> excluding the last dimension.</p>
<p>The optional parameter <code class="docutils literal notranslate"><span class="pre">grid</span></code> is for convenience. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>,
a singleton dimension is appended (prepended) to <code class="docutils literal notranslate"><span class="pre">theta</span></code> (<code class="docutils literal notranslate"><span class="pre">phi</span></code>)
for broadcasting to a regular grid. The other inputs <code class="docutils literal notranslate"><span class="pre">radius</span></code> and
<code class="docutils literal notranslate"><span class="pre">coeffs</span></code> must then be broadcastable as before but now with the resulting
regular grid.</p>
<p class="rubric">Examples</p>
<p>The most straight forward computation uses a fully specified grid. For
example, compute the magnetic field at <span class="math notranslate nohighlight">\(N=50\)</span> grid points on the
surface.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">chaosmagpy.model_utils</span> <span class="kn">as</span> <span class="nn">cpm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,))</span>  <span class="c1"># degree 1 coefficients for all points</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">6371.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,))</span>  <span class="c1"># radius of 50 points in km</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># azimuth of 50 points in deg.</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># colatitude of 50 points in deg.</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">cpm</span><span class="o">.</span><span class="n">synth_values</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="k">print</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># (N,) shaped output</span>
</pre></div>
</div>
<p>Instead of <cite>N</cite> points, compute the field on a regular
<span class="math notranslate nohighlight">\(N\times N\)</span>-grid in azimuth and colatitude (slow).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">radius_grid</span> <span class="o">=</span> <span class="mf">6371.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="n">phi_grid</span><span class="p">,</span> <span class="n">theta_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>  <span class="c1"># regular NxN grid</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">cpm</span><span class="o">.</span><span class="n">synth_values</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">radius_grid</span><span class="p">,</span> <span class="n">theta_grid</span><span class="p">,</span> <span class="n">phi_grid</span><span class="p">)</span>
<span class="k">print</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># NxN output</span>
</pre></div>
</div>
<p>But this is slow since some computations on the grid are executed several
times. The preferred method is to use NumPy’s broadcasting rules (fast).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">radius_grid</span> <span class="o">=</span> <span class="mf">6371.2</span>  <span class="c1"># float, () or (1,)-shaped array broadcasted to NxN</span>
<span class="n">phi_grid</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>  <span class="c1"># prepend singleton: 1xN</span>
<span class="n">theta_grid</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>  <span class="c1"># append singleton: Nx1</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">cpm</span><span class="o">.</span><span class="n">synth_values</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">radius_grid</span><span class="p">,</span> <span class="n">theta_grid</span><span class="p">,</span> <span class="n">phi_grid</span><span class="p">)</span>
<span class="k">print</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># NxN output</span>
</pre></div>
</div>
<p>For convenience, you can do the same by using <code class="docutils literal notranslate"><span class="pre">grid=True</span></code> option.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">cpm</span><span class="o">.</span><span class="n">synth_values</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">radius_grid</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># NxN output</span>
</pre></div>
</div>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">grid=False</span></code> (or left out completely) will result in
(N,)-shaped outputs as in the first example.</p>
</dd></dl>

</div>
<div class="section" id="module-plot_utils">
<span id="plotting-utilities-plot-utils"></span><h3>Plotting utilities (<cite>plot_utils</cite>)<a class="headerlink" href="#module-plot_utils" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_utils.defaultkeys">
<code class="descclassname">plot_utils.</code><code class="descname">defaultkeys</code><span class="sig-paren">(</span><em>defaults</em>, <em>keywords</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#defaultkeys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.defaultkeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary of default keywords. Overwrite any keywords in
<code class="docutils literal notranslate"><span class="pre">defaults</span></code> using keywords from <code class="docutils literal notranslate"><span class="pre">keywords</span></code>, except if they are None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>defaults, keywords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Dictionary of default and replacing keywords.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>keywords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="plot_utils.fmt">
<code class="descclassname">plot_utils.</code><code class="descname">fmt</code><span class="sig-paren">(</span><em>x</em>, <em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#fmt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="plot_utils.nio_colormap">
<code class="descclassname">plot_utils.</code><code class="descname">nio_colormap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#nio_colormap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.nio_colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Define custom-built colormap ‘nio’ and register. Can be called in plots as
<code class="docutils literal notranslate"><span class="pre">cmap='nio'</span></code> after importing this module.</p>
</dd></dl>

<dl class="function">
<dt id="plot_utils.plot_maps">
<code class="descclassname">plot_utils.</code><code class="descname">plot_maps</code><span class="sig-paren">(</span><em>theta_grid</em>, <em>phi_grid</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#plot_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.plot_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a global map showing the input arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta_grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array containing the colatitude in degrees.</p>
</dd>
<dt><strong>phi_grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array containing the longitude in degrees.</p>
</dd>
<dt><strong>*args</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array of values to plot on the global map. Several
arrays can be provided as separated arguments.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>fig</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></span></dt>
<dd><p class="first last">Matplotlib figure.</p>
</dd>
<dt><strong>axes</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code>, ndarray</span></dt>
<dd><p class="first last">Array of which singleton dimenions have been squeezed out. Only the
axes instance is returned in case of a single axis.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>figsize</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of floats</span></dt>
<dd><p class="first last">Figure dimension (width, height) in inches.</p>
</dd>
<dt><strong>titles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">Subplot titles (defaults to empty strings).</p>
</dd>
<dt><strong>label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Colorbar label (defaults to an empty string).</p>
</dd>
<dt><strong>layout</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of int</span></dt>
<dd><p class="first last">Layout of the subplots (defaults to vertically stacked subplots).</p>
</dd>
<dt><strong>cmap</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Colormap code (defaults to <code class="docutils literal notranslate"><span class="pre">'PuOr'</span></code> colormap).</p>
</dd>
<dt><strong>limiter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function, lambda expression</span></dt>
<dd><p class="first last">Function to compute symmetric colorbar limits (defaults to maximum of
the absolute values in the input, or use <code class="docutils literal notranslate"><span class="pre">'vmin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'vmax'</span></code>
keywords instead).</p>
</dd>
<dt><strong>projection</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cartopy.crs</span></code></span></dt>
<dd><p class="first last">Projection of the target frame (defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">cartopy.crs.Mollweide()</span></code>).</p>
</dd>
<dt><strong>transform</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cartopy.crs</span></code></span></dt>
<dd><p class="first last">Projection of input frame (defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">cartopy.crs.PlateCarree()</span></code>)</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to matplotlib <code class="xref py py-func docutils literal notranslate"><span class="pre">pcolormesh()</span></code> method.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="plot_utils.plot_power_spectrum">
<code class="descclassname">plot_utils.</code><code class="descname">plot_power_spectrum</code><span class="sig-paren">(</span><em>spectrum</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#plot_power_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.plot_power_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot spherical harmonic spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>spectrum</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Spherical harmonics spectrum of degree <cite>N</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>fig</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></span></dt>
<dd><p class="first last">Matplotlib figure.</p>
</dd>
<dt><strong>axes</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></span></dt>
<dd><p class="first last">A single axes instance.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>figsize</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of floats</span></dt>
<dd><p class="first last">Figure dimension (width, height) in inches.</p>
</dd>
<dt><strong>titles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">Subplot titles (defaults to empty strings).</p>
</dd>
<dt><strong>ylabel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Label of the vertical axis (defaults to an empty string).</p>
</dd>
<dt><strong>**kwargs</strong></dt>
<dd><p class="first last">Keywords passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.semilogy()</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="plot_utils.plot_timeseries">
<code class="descclassname">plot_utils.</code><code class="descname">plot_timeseries</code><span class="sig-paren">(</span><em>time</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plot_utils.html#plot_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#plot_utils.plot_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a line plot showing the timeseries of the input arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing time in modified Julian dates.</p>
</dd>
<dt><strong>*args</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N, k)</span></dt>
<dd><p class="first last">Array containing <cite>k</cite> columns of values to plot against time. Several
arrays can be provided as separated arguments.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>fig</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></span></dt>
<dd><p class="first last">Matplotlib figure.</p>
</dd>
<dt><strong>axes</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code>, ndarray</span></dt>
<dd><p class="first last">Array of which singleton dimenions have been squeezed out. Only the
axes instance is returned in case of a single axis.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>figsize</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of floats</span></dt>
<dd><p class="first last">Figure dimension (width, height) in inches.</p>
</dd>
<dt><strong>titles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">Subplot titles (defaults to empty strings).</p>
</dd>
<dt><strong>ylabel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Label of the vertical axis (defaults to an empty string).</p>
</dd>
<dt><strong>layout</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2-tuple of int</span></dt>
<dd><p class="first last">Layout of the subplots (defaults to vertically stacked subplots).</p>
</dd>
<dt><strong>**kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">keywords</span></dt>
<dd><p class="first last">Other options to pass to matplotlib plotting method.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-data_utils">
<span id="data-utilities-data-utils"></span><h3>Data utilities (<cite>data_utils</cite>)<a class="headerlink" href="#module-data_utils" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="data_utils.dyear_to_mjd">
<code class="descclassname">data_utils.</code><code class="descname">dyear_to_mjd</code><span class="sig-paren">(</span><em>time</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#dyear_to_mjd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.dyear_to_mjd" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time from decimal years to modified Julian date 2000. Leap years
are accounted for by default.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time in decimal years.</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap years into account by using a conversion factor of 365 or 366
days in a year (leap year, used by default). If <code class="docutils literal notranslate"><span class="pre">False</span></code> a conversion
factor of 365.25 days in a year is used.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time in modified Julian date 2000.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.gauss_units">
<code class="descclassname">data_utils.</code><code class="descname">gauss_units</code><span class="sig-paren">(</span><em>deriv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#gauss_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.gauss_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string of the magnetic field units given the derivative with time.
String is meant to be parsed to plot labels.</p>
</dd></dl>

<dl class="function">
<dt id="data_utils.load_RC_datfile">
<code class="descclassname">data_utils.</code><code class="descname">load_RC_datfile</code><span class="sig-paren">(</span><em>filepath=None</em>, <em>parse_dates=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#load_RC_datfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.load_RC_datfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load RC-index data file into pandas data frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Filepath to RC index <code class="docutils literal notranslate"><span class="pre">*.dat</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the RC
index will be fetched from <a class="reference external" href="http://www.spacecenter.dk/files/magnetic-models/RC/current/">spacecenter.dk</a>.</p>
</dd>
<dt><strong>parse_dates</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Replace index with datetime object for time-series manipulations.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>df</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dataframe</span></dt>
<dd><p class="first last">Pandas dataframe with names {‘time’, ‘RC’, ‘RC_e’, ‘RC_i’, ‘flag’},
where <code class="docutils literal notranslate"><span class="pre">'time'</span></code> is given in modified Julian dates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.load_matfile">
<code class="descclassname">data_utils.</code><code class="descname">load_matfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>variable_name</em>, <em>struct=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#load_matfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.load_matfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load variable from matfile. Can handle mat-files v7.3 and before.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Filepath to mat-file.</p>
</dd>
<dt><strong>variable_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Name of variable or struct to be loaded from mat-file.</p>
</dd>
<dt><strong>struct</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{False, True}, optional</span></dt>
<dd><p class="first last">If struct is to be loaded from mat-file, use <code class="docutils literal notranslate"><span class="pre">True</span></code> (only required
before v7.3 mat-files).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>variable</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, dict</span></dt>
<dd><p class="first last">Array or dictionary (if <code class="docutils literal notranslate"><span class="pre">struct=True</span></code>) containing the values.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.load_shcfile">
<code class="descclassname">data_utils.</code><code class="descname">load_shcfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#load_shcfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.load_shcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load shc-file and return coefficient arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">File path to spherical harmonic coefficient shc-file.</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap year in time conversion into account (default). Otherwise,
use conversion factor of 365.25 days per year.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (N,)</span></dt>
<dd><p class="first last">Array containing <cite>N</cite> times for each model snapshot in modified
Julian dates with origin January 1, 2000 0:00 UTC.</p>
</dd>
<dt><strong>coeffs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (nmax(nmax+2), N)</span></dt>
<dd><p class="first last">Coefficients of model snapshots. Each column is a snapshot up to
spherical degree and order <cite>nmax</cite>.</p>
</dd>
<dt><strong>parameters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict, {‘SHC’, ‘nmin’, ‘nmax’, ‘N’, ‘order’, ‘step’}</span></dt>
<dd><p class="first last">Dictionary containing parameters of the model snapshots and the
following keys: <code class="docutils literal notranslate"><span class="pre">'SHC'</span></code> shc-file name, <cite>nmin</cite> minimum degree,
<code class="docutils literal notranslate"><span class="pre">'nmax'</span></code> maximum degree, <code class="docutils literal notranslate"><span class="pre">'N'</span></code> number of snapshot models,
<code class="docutils literal notranslate"><span class="pre">'order'</span></code> piecewise polynomial order and <code class="docutils literal notranslate"><span class="pre">'step'</span></code> number of
snapshots until next break point. Extract break points of the
piecewise polynomial with <code class="docutils literal notranslate"><span class="pre">breaks</span> <span class="pre">=</span> <span class="pre">time[::step]</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.memory_usage">
<code class="descclassname">data_utils.</code><code class="descname">memory_usage</code><span class="sig-paren">(</span><em>pandas_obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#memory_usage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.memory_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute memory usage of pandas object. For full report, use:
<code class="docutils literal notranslate"><span class="pre">df.info(memory_usage='deep')</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="data_utils.mjd2000">
<code class="descclassname">data_utils.</code><code class="descname">mjd2000</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#mjd2000"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.mjd2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the modified Julian date as floating point number. It assigns 0 to
0h00 January 1, 2000. Leap seconds are not accounted for.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a></span></dt>
<dd><p class="first last">Datetime class instance, <cite>OR …</cite></p>
</dd>
<dt><strong>year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd></dd>
<dt><strong>month</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Month of the year <cite>[1, 12]</cite>.</p>
</dd>
<dt><strong>day</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Day of the corresponding month.</p>
</dd>
<dt><strong>hour</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Hour of the day <cite>[0, 23]</cite> (default is 0).</p>
</dd>
<dt><strong>minute</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Minutes of the hour <cite>[0, 59]</cite> (default is 0).</p>
</dd>
<dt><strong>second</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Seconds of the minute <cite>[0, 59]</cite> (default is 0).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Modified Julian date (units of days).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.mjd_to_dyear">
<code class="descclassname">data_utils.</code><code class="descname">mjd_to_dyear</code><span class="sig-paren">(</span><em>time</em>, <em>leap_year=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#mjd_to_dyear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.mjd_to_dyear" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time in modified Julian date 2000 to decimal years. Leap years are
accounted for by default.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time in modified Julian date 2000.</p>
</dd>
<dt><strong>leap_year</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{True, False}, optional</span></dt>
<dd><p class="first last">Take leap years into account by using a conversion factor of 365 or 366
days in a year (leap year, used by default). If <code class="docutils literal notranslate"><span class="pre">False</span></code> a conversion
factor of 365.25 days in a year is used.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time in decimal years.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.rsme">
<code class="descclassname">data_utils.</code><code class="descname">rsme</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#rsme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.rsme" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RSME (root square mean error) of inputs x and y.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x, y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="data_utils.save_RC_h5file">
<code class="descclassname">data_utils.</code><code class="descname">save_RC_h5file</code><span class="sig-paren">(</span><em>filepath</em>, <em>read_from=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_utils.html#save_RC_h5file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_utils.save_RC_h5file" title="Permalink to this definition">¶</a></dt>
<dd><p>Return h5-file of the RC index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Filepath and name of <code class="docutils literal notranslate"><span class="pre">*.h5</span></code> output file.</p>
</dd>
<dt><strong>read_from</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Filepath of RC index <code class="docutils literal notranslate"><span class="pre">*.dat</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the RC
index will be fetched from <a class="reference external" href="http://www.spacecenter.dk/files/magnetic-models/RC/current/">spacecenter.dk</a>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Saves an h5-file of the RC index with keywords
[‘time’, ‘RC’, ‘RC_e’, ‘RC_i’, ‘flag’]. Time is given in modified Julian
dates 2000.</p>
</dd></dl>

</div>
<div class="section" id="module-config_utils">
<span id="configuration-utilities-config-utils"></span><span id="label-configuration-list"></span><h3>Configuration utilities (<cite>config_utils</cite>)<a class="headerlink" href="#module-config_utils" title="Permalink to this headline">¶</a></h3>
<p>Parameters and options in ChaosMagPy are stored in a dictionary and can be
modified as desired. The following list gives an overview of the possible
keywords.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="18%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>‘params.r_surf’</td>
<td><cite>float</cite></td>
<td>Reference radius in kilometers (defaults
to Earth’s surface radius 6371.2 km).</td>
</tr>
<tr class="row-odd"><td>‘params.r_cmb’</td>
<td><cite>float</cite></td>
<td>Core-mantle boundary radius in kilometers
(defaults to 3485.0 km).</td>
</tr>
<tr class="row-even"><td>‘params.dipole’</td>
<td><cite>list</cite>,
<cite>ndarray</cite>,
<cite>shape (3,)</cite></td>
<td>Coefficients of the dipole (used for
GSM/SM coordinate transformations).</td>
</tr>
<tr class="row-odd"><td>‘params.version’</td>
<td><cite>str</cite></td>
<td>Default version of the CHAOS model, e.g.
<code class="docutils literal notranslate"><span class="pre">'6.x7'</span></code>.</td>
</tr>
<tr class="row-even"><td>‘params.cdf_to_mjd’</td>
<td><cite>int</cite></td>
<td>Number of days on Jan 01, 2000 since Jan
01, 0000 (CDF start epoch)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Files</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="15%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>‘files.RC_index’</td>
<td><cite>h5-file</cite>,
<cite>txt-file</cite></td>
<td>RC-index file (used for external
field computation). See also
<a class="reference internal" href="#data_utils.save_RC_h5file" title="data_utils.save_RC_h5file"><code class="xref py py-func docutils literal notranslate"><span class="pre">data_utils.save_RC_h5file()</span></code></a>.</td>
</tr>
<tr class="row-odd"><td>‘files.GSM_spectrum’</td>
<td><cite>npz-file</cite></td>
<td>GSM transformation coefficients. See
also <a class="reference internal" href="#coordinate_utils.rotate_gauss_fft" title="coordinate_utils.rotate_gauss_fft"><code class="xref py py-func docutils literal notranslate"><span class="pre">coordinate_utils.rotate_gauss_fft()</span></code></a>.</td>
</tr>
<tr class="row-even"><td>‘files.SM_spectrum’</td>
<td><cite>npz-file</cite></td>
<td>SM transformation coefficients. See
also <a class="reference internal" href="#coordinate_utils.rotate_gauss_fft" title="coordinate_utils.rotate_gauss_fft"><code class="xref py py-func docutils literal notranslate"><span class="pre">coordinate_utils.rotate_gauss_fft()</span></code></a>.</td>
</tr>
<tr class="row-odd"><td>‘files.Earth_conductivity’</td>
<td><cite>txt-file</cite></td>
<td>Conductivity model of a layered Earth
(used for induced fields).</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>Plots</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="15%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>‘plots.figure_width’</td>
<td><cite>float</cite></td>
<td>Plot width in inches (defaults to 6.3
or equiv. 16cm)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="class">
<dt id="config_utils.BasicConfig">
<em class="property">class </em><code class="descclassname">config_utils.</code><code class="descname">BasicConfig</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Class for creating CHAOS configuration dictionary.</p>
<dl class="method">
<dt id="config_utils.BasicConfig.context">
<code class="descname">context</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig.context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig.context" title="Permalink to this definition">¶</a></dt>
<dd><p>Use context manager to temporarily change setting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>key</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">BasicConfig configuration key.</p>
</dd>
<dt><strong>value</strong></dt>
<dd><p class="first last">Value compatible with <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Temporarily change the radius of Earth’s surface for a computation
and then change it back to the original value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chaosmagpy</span> <span class="kn">import</span> <span class="n">basicConfig</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Before: &#39;</span><span class="p">,</span> <span class="n">basicConfig</span><span class="p">[</span><span class="s1">&#39;params.r_surf&#39;</span><span class="p">])</span>

<span class="c1"># change Earth&#39;s radius to 10 km</span>
<span class="k">with</span> <span class="n">basicConfig</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;params.r_surf&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="c1"># do something at r_surf = 10 km ...</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Inside: &#39;</span><span class="p">,</span> <span class="n">basicConfig</span><span class="p">[</span><span class="s1">&#39;params.r_surf&#39;</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;After: &#39;</span><span class="p">,</span> <span class="n">basicConfig</span><span class="p">[</span><span class="s1">&#39;params.r_surf&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="config_utils.BasicConfig.fullreset">
<code class="descname">fullreset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig.fullreset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig.fullreset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all default values.</p>
</dd></dl>

<dl class="method">
<dt id="config_utils.BasicConfig.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load configuration dictionary from file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Filepath and name to configuration textfile.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="config_utils.BasicConfig.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>key</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Single keyword that is reset to the default.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="config_utils.BasicConfig.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#BasicConfig.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.BasicConfig.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save configuration dictionary to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filepath</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Filepath and name of the textfile that will be saved with the
configuration values.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="config_utils.check_float">
<code class="descclassname">config_utils.</code><code class="descname">check_float</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to float.</p>
</dd></dl>

<dl class="function">
<dt id="config_utils.check_int">
<code class="descclassname">config_utils.</code><code class="descname">check_int</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to integer.</p>
</dd></dl>

<dl class="function">
<dt id="config_utils.check_path_exists">
<code class="descclassname">config_utils.</code><code class="descname">check_path_exists</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_path_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_path_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that path to file exists.</p>
</dd></dl>

<dl class="function">
<dt id="config_utils.check_string">
<code class="descclassname">config_utils.</code><code class="descname">check_string</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to string.</p>
</dd></dl>

<dl class="function">
<dt id="config_utils.check_vector">
<code class="descclassname">config_utils.</code><code class="descname">check_vector</code><span class="sig-paren">(</span><em>s</em>, <em>len=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that input is vector with required length.</p>
</dd></dl>

<dl class="function">
<dt id="config_utils.check_version_string">
<code class="descclassname">config_utils.</code><code class="descname">check_version_string</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/config_utils.html#check_version_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#config_utils.check_version_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Check correct format of version string.</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-chaos">Core functionality (<cite>CHAOS</cite>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-functionality">Additional functionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-coordinate_utils">Coordinate transformations (<cite>coordinate_utils</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-model_utils">Model utilities (<cite>model_utils</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-plot_utils">Plotting utilities (<cite>plot_utils</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-data_utils">Data utilities (<cite>data_utils</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-config_utils">Configuration utilities (<cite>config_utils</cite>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="usage.html"
                        title="previous chapter">Usage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changelog.html"
                        title="next chapter">Changelog</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/references.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             >next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ChaosMagPy 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Clemens Kloss.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>